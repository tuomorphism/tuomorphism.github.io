---
import { getCollection } from 'astro:content';

const projects = await getCollection('projects');
const sorted = projects.sort((a,b) => a.data.tier - b.data.tier);
---

<section class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
  <h1 class="text-3xl font-serif mb-8">Projects</h1>
  <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 auto-rows-[200px]">
    {sorted.map((p) => (
      <a
        href={`/projects/${p.slug}`}
        class={`relative rounded-lg overflow-hidden shadow group
          ${p.data.tier === 1 ? 'sm:col-span-2 sm:row-span-2' : ''}
          ${p.data.tier === 3 ? 'opacity-80' : ''}`}
      >
        {p.data.image && (
          <img
            src={p.data.image}
            alt=""
            class="absolute inset-0 h-full w-full object-cover transition-transform duration-300 group-hover:scale-105"
          />
        )}
        <div class="absolute inset-0 bg-black/50 p-4 flex flex-col justify-end">
          <h2 class="text-lg font-semibold text-white">{p.data.title}</h2>
          <p class="text-sm text-white/80">{p.data.description}</p>
        </div>
      </a>
    ))}
  </div>
</section>
