---
import type { CollectionEntry } from 'astro:content';
import ProjectActions from './ProjectActions.astro';
import ProjectBlogPosts from './ProjectBlogPosts.astro';

interface Props {
  project: CollectionEntry<'projects'>;
  uid: string;
  previewCount?: number;
}
const { project, uid, previewCount = 2 } = Astro.props as Props;
const data = project.data;
---

<article class="flex h-full flex-col overflow-hidden rounded-xl border border-zinc-200 dark:border-zinc-700 bg-white dark:bg-zinc-800 shadow-sm hover:shadow-md transition-shadow">
  {data.image && (
    <img
      src={data.image}
      alt={data.title}
      class="hidden sm:block h-40 w-full object-cover"
    />
  )}

  <!-- Use internal dividers for clean subsections -->
  <div class="flex-1 flex flex-col divide-y divide-zinc-200/80 dark:divide-zinc-700/80">
    <!-- Header: title + actions -->
    <header class="p-5 flex items-start justify-between gap-3">
      <div class="min-w-0">
        <h3 class="text-base sm:text-lg font-semibold text-zinc-900 dark:text-white truncate">
          {data.title}
        </h3>
        <p class="mt-1 text-sm text-zinc-600 dark:text-zinc-300">
          {data.description}
        </p>
      </div>
      <ProjectActions links={data.links} />
    </header>

    <!-- Blog posts section (auto separated by divider) -->
    <ProjectBlogPosts posts={data.blog_posts} uid={uid} previewCount={previewCount} />
  </div>
</article>
